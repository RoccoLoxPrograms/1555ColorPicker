<!DOCTYPE html> <!-- May 2021 - RoccoLox Programs -->
<!--
    Thank you epsilon5. This wouldn't exist without you.
    Thank you Zeroko, for your rgb1555 to rgb888 conversion code.
    Thank you to anyone else who suggested features and has used this program.
-->
<html lang="en">
    <head>
        <title>1555 Color Picker</title>
        <style type="text/css">
            body {
                background-color: rgb(243,243,243);
            }
            div.table {
                display: flex;
                border-width: 1px;
                margin: 10px auto;
                border: solid black 1px;
                justify-content: center;
            }
            div.osColors {
                display: flex;
                padding: 1px;
                width: 100%;
                justify-content: center;
                align-items: center;
                color: #ffffff;
                font-family: sans-serif;
                font-weight: bold;
                cursor: pointer;
                height: 35px;
            }
            h1 {
                margin: 5px 0px 0px 0px;
                text-align: center;
                font-size: 250%;
                font-family: sans-serif;
                font-weight: normal;
                text-decoration: underline;
            }
            h3 {
                color: #000000;
                margin: 0px;
                cursor: pointer;
            }
            p {
                text-align: center;
                font-weight: bold;
                font-size: 200%;
                padding: 8%;
                font-family: sans-serif;
                margin: 20px auto 35px auto;
            }
            footer {
                background-color: rgb(243,243,243);
                bottom: 0px;
                left: 0px;
                position: fixed;
                width: 100%;
            }
            a {
                text-decoration: none;
                color: #0179f9;
                font-family: sans-serif;
                font-size: 110%;
                padding: 0px 5px 5px 5px;
            }
            input {
                border-radius: 6px;
                border-width: 1px;
            }
            input:focus {
                outline-width: 0px;
            }
            input.numberValue {
                padding: inherit;
                font-size: 100%;
                text-align: center;
            }
            input.textValue {
                padding: inherit;
                font-size: 100%;
                text-align: center;
                width: 150px;
            }
            /* slider styling */
            .slider {
                -webkit-appearance: none;
                appearance: none;
                width: 100%;
                height: 20px;
                border-radius: 10px;
                background: rgb(150,150,150);
                outline: none;
                opacity: 0.7;
                -webkit-transition: .3s;
                transition: opacity .3s;
            }
            .slider:hover {
                opacity: 1;
            }
            .slider::-webkit-slider-thumb {
                -webkit-appearance: none;
                appearance: none;
                width: 30px;
                height: 30px;
                border-radius: 50%;
                border: 1px white solid;
                background: #000000;
                cursor: pointer;
            }
            .slider::-moz-range-thumb {
                width: 30px;
                height: 30px;
                border-radius: 50%;
                background: #000000;
                cursor: pointer;
            }
        </style>
        <script type="text/javascript">
            function updateValues(red, green, blue, color1555) {
                document.getElementById("1555slider").value = color1555;
                c1555 = parseInt(color1555).toString(16).toUpperCase(); // get the 1555 hex value
                document.getElementById("1555userValue").value = c1555;
                // make sure the length is 6
                if (c1555.length == 1) c1555 = '0x000' + c1555;
                else if (c1555.length == 2) c1555 = '0x00' + c1555;
                else if (c1555.length == 3) c1555 = '0x0' + c1555;
                else if (c1555.length == 4) c1555 = '0x' + c1555;
                var pal1 = c1555.substring(4,6); // first palette color
                var pal2 = c1555.substring(0,4); // second palette color
                // find the hex value for the rgb color
                var redHex = parseInt(red).toString(16).toUpperCase();
                var greenHex = parseInt(green).toString(16).toUpperCase();
                var blueHex = parseInt(blue).toString(16).toUpperCase();
                // update values and redisplay them
                document.getElementById("redUserValue").value = red;
                document.getElementById("greenUserValue").value = green;
                document.getElementById("blueUserValue").value = blue;
                document.getElementById("1555hexValue").innerHTML = `1555: ${c1555}&nbsp; &nbsp; &nbsp; Palette: 0x${pal1}, ${pal2}`;
                // thank you Zeroko
                red = Math.floor((color1555 >> 10 & 31) * 255 / 31);
                green = Math.floor((color1555 >> 10 & 32 | color1555 >> 5 & 31) * 255 / 31);
                blue = Math.floor((color1555 & 31) * 255 / 31);
                // update the color box
                if (localStorage.getItem("RLP_color_picker_color_mode_090419") == "dark") document.getElementById("text").setAttribute("style",`background-color: rgb(${red}, ${green}, ${blue}); border-color: #ffffff; border-width: thin; border-style: solid;`);
                else document.getElementById("text").setAttribute("style",`background-color: rgb(${red}, ${green}, ${blue}); border-color: #000000; border-width: thin; border-style: solid;`);
                // update the hex value box
                if (redHex.length == 1) redHex = '0' + redHex;
                if (greenHex.length == 1) greenHex = '0' + greenHex;
                if (blueHex.length == 1) blueHex = '0' + blueHex;
                document.getElementById("hexUserValue").value = redHex + greenHex + blueHex;
            }

            function RGBto1555(red, green, blue) { // convert the rgb to 1555
                var c1555 = ((red >> 3) << 10) | ((green >> 3) << 5) | (blue >> 3); // thank you MateoConLechuga (taken from the CE C toolchain)
                return c1555;
            }

            function changeMode() {
                if (localStorage.getItem("RLP_color_picker_color_mode_090419") == 'light') { // change mode
                    localStorage.setItem("RLP_color_picker_color_mode_090419","dark");
                    darkMode(); 
                } else {
                    localStorage.setItem("RLP_color_picker_color_mode_090419","light");
                    lightMode();
                }
            }

            function lightMode() {
                document.getElementById("body").setAttribute("style","background-color: rgb(243,243,243);"); // chanhe background
                document.getElementsByTagName("footer")[0].setAttribute("style","background-color: rgb(243,243,243);"); // change footer background
                document.getElementById('changeColorPicker').setAttribute('style','font-size: 100%;  margin: 0px 0px 15px 0px; padding: 0px; font-weight: normal; color: #000000;');
                document.getElementById("OSColors").setAttribute("style","border-color: #000000;"); // change border color
                document.getElementById("TI").setAttribute("style","font-size: 170%; font-family: sans-serif; font-weight: bold; text-align: center; margin: 5px 0px; padding: 0px;"); // change text color
                document.getElementById("1555hexValue").setAttribute("style","font-size: 175%; padding: 0px; margin: 5px; color: #000000;");
                document.getElementById("text").setAttribute("style",`background-color: rgb(${red}, ${green}, ${blue}); border-color: #000000; border-width: thin; border-style: solid;`);
                document.getElementById("userInput").setAttribute("style","padding: 0px; margin: unset; font-size: 150%; color: #000000;");
                document.getElementById("title").setAttribute("style","color: #000000;"); // change text color
                document.getElementById("mode").setAttribute("style","color: #000000; float: left;");
                document.getElementById("copyright").setAttribute("style","color: #808080; float: right;");
                document.getElementById("mode").innerHTML = 'Switch to Dark Mode'; // change option
            }

            function darkMode() {
                document.getElementById("body").setAttribute("style","background-color: rgb(40,40,40);"); // chanhe background
                document.getElementsByTagName("footer")[0].setAttribute("style","background-color: rgb(40,40,40);"); // change footer background
                document.getElementById('changeColorPicker').setAttribute('style','font-size: 100%;  margin: 0px 0px 15px 0px; padding: 0px; font-weight: normal; color: #ffffff;');
                document.getElementById("OSColors").setAttribute("style","border-color: #ffffff;"); // change border color
                document.getElementById("TI").setAttribute("style","font-size: 170%; font-family: sans-serif; font-weight: bold; text-align: center; margin: 5px 0px; padding: 0px; color: #ffffff;"); // change text color
                document.getElementById("1555hexValue").setAttribute("style","font-size: 175%; padding: 0px; margin: 5px; color: #ffffff;");
                document.getElementById("text").setAttribute("style",`background-color: rgb(${red}, ${green}, ${blue}); border-color: #ffffff; border-width: thin; border-style: solid;`);
                document.getElementById("userInput").setAttribute("style","padding: 0px; margin: unset; font-size: 150%; color: #ffffff;");
                document.getElementById("title").setAttribute("style","color: #ffffff;"); // change text color
                document.getElementById("mode").setAttribute("style","color: #ffffff; float: left;");
                document.getElementById("copyright").setAttribute("style","color: #b3b3b3; float: right;");
                document.getElementById("mode").innerHTML = 'Switch to Light Mode'; // change option
            }

            function hover(n, r, g, b) {
                onMouseOut(); // remove the hover box
                // draw new hover box
                if (n < 10 || n == 15 ) document.getElementsByTagName('div')[n].setAttribute("style",`background-color: rgb(${r}, ${g}, ${b}); border: solid white 1px; padding: 0px; color: #ffffff;`);
                else document.getElementsByTagName('div')[n].setAttribute("style",`background-color: rgb(${r}, ${g}, ${b}); border: solid black 1px; padding: 0px; color: #000000;`);
                // update values
                oldn = n;
                oldr = r;
                oldg = g;
                oldb = b;
            }

            function onMouseOut() { // when not over a table, remove the hover box
                if (oldn < 10 || oldn == 15) document.getElementsByTagName('div')[oldn].setAttribute("style",`background-color: rgb(${oldr}, ${oldg}, ${oldb});`);
                else document.getElementsByTagName('div')[oldn].setAttribute("style",`background-color: rgb(${oldr}, ${oldg}, ${oldb}); color: #000000;`);
            }

            function info() { // short description
                alert("1555 Color Picker\nBy RoccoLox Programs\nVersion: 1.0\nDate: 2021-07-23\nLicense: BSD 3-Clause License\nDescription: 1555 color picker for C and Assembly programmers on the TI-84 Plus CE.");
            }
        </script>
    </head>
    <body id="body">
        <h3 id="mode" onclick="changeMode()" style="float: left;">Switch to Dark Mode</h3> <!-- mode selector -->
        <h3 id="copyright" style="color: #808080; float: right;" onclick="info()">&copy; 2021 RoccoLox Programs</h3>
        <br>
        <h1 id="title">1555 Color Picker</h1>
        <p id="changeColorPicker" style="font-size: 100%;  margin: 0px 0px 15px 0px; padding: 0px; font-weight: normal;">
            (<a href="https://roccoloxprograms.github.io/XlibcColorPicker" style="padding: 0px;">Xlibc Color Picker</a>)
        </p>
        <input type="range" min="0" max="32767" value="0" class="slider" id="1555slider">
        <br>
        <br>
        <p style="padding: 0px; margin: unset; font-size: 150%;" id="userInput">
            1555 (hex): <input type="text" value="0" class="textValue" id="1555userValue">&nbsp;
            &nbsp; RED: <input type="number" min="0" max="255" value="0" class="numberValue" id="redUserValue">
            GREEN: <input type="number" min="0" max="255" value="0" class="numberValue" id="greenUserValue">
            BLUE: <input type="number" min="0" max="255" value="0" class="numberValue" id="blueUserValue">&nbsp;
            &nbsp; HEX: <input type="text" value="000000" class="textValue" id="hexUserValue">
        </p>
        <br>
        <p id="1555hexValue" style="font-size: 175%; padding: 0px; margin: 5px;">1555: 0x0000&nbsp; &nbsp; &nbsp; Palette: 0x00, 0x00</p>
        <p id="text" style="background-color: #000000; border-color: #000000; border-width: thin; border-style: solid;"></p>
        <div class="table" id="OSColors" onmouseout="onMouseOut()"> <!-- TI-OS color table -->
            <div class="osColors" style="background-color: rgb(0,0,255);" onclick="updateValues(0,0,255,31)" onmouseover="hover(1,0,0,255)">BLUE</div>
            <div class="osColors" style="background-color: rgb(255,0,0);" onclick="updateValues(255,0,0,31744)" onmouseover="hover(2,255,0,0)">RED</div>
            <div class="osColors" style="background-color: rgb(0, 0, 0);" onclick="updateValues(0,0,0,0)" onmouseover="hover(3,0,0,0)">BLACK</div>
            <div class="osColors" style="background-color: rgb(255,0,255);" onclick="updateValues(255,0,255,31775)" onmouseover="hover(4,255,0,255)">MAGENTA</div>
            <div class="osColors" style="background-color: rgb(0,158,0);" onclick="updateValues(0,158,0,608)" onmouseover="hover(5,0,158,0)">GREEN</div>
            <div class="osColors" style="background-color: rgb(255,132,42);" onclick="updateValues(255,132,42,32293)" onmouseover="hover(6,255,132,42)">ORANGE</div>
            <div class="osColors" style="background-color: rgb(182,32,0);" onclick="updateValues(182,32,0,22656)" onmouseover="hover(7,182,32,0)">BROWN</div>
            <div class="osColors" style="background-color: rgb(0,0,134);" onclick="updateValues(0,0,134,16)" onmouseover="hover(8,0,0,134)">NAVY</div>
            <div class="osColors" style="background-color: rgb(0,146,255);" onclick="updateValues(0,146,255,607)" onmouseover="hover(9,0,146,255)">LTBLUE</div>
            <div class="osColors" style="background-color: rgb(255,255,0); color: #000000;" onclick="updateValues(255,255,0,32736)" onmouseover="hover(10,255,255,0)">YELLOW</div>
            <div class="osColors" style="background-color: rgb(255,255,255); color: #000000;" onclick="updateValues(255,255,255,32767)" onmouseover="hover(11,255,255,255)">WHITE</div>
            <div class="osColors" style="background-color: rgb(231,227,231); color: #000000;" onclick="updateValues(231,227,231,29596)" onmouseover="hover(12,231,227,231)">LTGRAY</div>
            <div class="osColors" style="background-color: rgb(199,195,199); color: #000000;" onclick="updateValues(199,195,199,25368)" onmouseover="hover(13,199,195,199)">MEDGRAY</div>
            <div class="osColors" style="background-color: rgb(142,138,142); color: #000000;" onclick="updateValues(142,138,142,17969)" onmouseover="hover(14,142,138,142)">GRAY</div>
            <div class="osColors" style="background-color: rgb(81,85,81);" onclick="updateValues(81,85,81,10570)" onmouseover="hover(15,81,85,81)">DARKGRAY</div>
        </div>
        <p  id ="TI" style="font-size: 170%; font-family: sans-serif; font-weight: bold; text-align: center; margin: 5px 0px; padding: 0px;">TI-OS Colors</p>
        <br> <!-- for smaller screen sizes -->
        <footer> <!-- advertising! -->
            <hr style="margin: 0px; margin-bottom: 5px;">
            <a href="https://www.cemetech.net/forum/viewtopic.php?p=294387#294387" target="_blank">Ask a question or suggest a feature</a>
            <a href="https://github.com/RoccoLoxPrograms/1555ColorPicker/releases" target="_blank" style="float: right;">Download the newest version</a>
        </footer>
        <script type="text/javascript">
            // get slider value
            document.getElementById("1555slider").oninput = function() {
                // convert 1555 to rgb
                red = Math.floor((this.value >> 10 & 31) * 255 / 31);
                green = Math.floor((this.value >> 10 & 32 | this.value >> 5 & 31) * 255 / 31);
                blue = Math.floor((this.value & 31) * 255 / 31);
                updateValues(red, green, blue, this.value);
            }

            // get 1555 input value
            document.getElementById("1555userValue").oninput = function() {
                var hex = this.value;
                // in case the string is too long or too short
                if (hex.length == 5) hex = hex.substring(1,5);
                if (hex.length == 0) hex = '0';
                var c1555 = parseInt(hex, 16).toString(10);
                // convert 1555 to rgb
                red = Math.floor((c1555 >> 10 & 31) * 255 / 31);
                green = Math.floor((c1555 >> 10 & 32 | c1555 >> 5 & 31) * 255 / 31);
                blue = Math.floor((c1555 & 31) * 255 / 31);
                updateValues(red, green, blue, c1555);
            }

            // get hex color input value
            document.getElementById("hexUserValue").oninput = function() {
                var hex = this.value;
                // in case the string is too long or too short
                if (hex.length == 7) hex = hex.substring(1,7);
                if (hex.length == 0) hex = '000000';
                // make sure the length is 6
                if (hex.length == 1) hex = '00000' + hex;
                else if (hex.length == 2) hex = '0000' + hex;
                else if (hex.length == 3) hex = '000' + hex;
                else if (hex.length == 4) hex = '00' + hex;
                else if (hex.length == 5) hex = '0' + hex;
                red = parseInt(hex.substring(0,2), 16).toString(10);
                green = parseInt(hex.substring(2,4), 16).toString(10);
                blue = parseInt(hex.substring(4,hex.length), 16).toString(10);
                var c1555 = RGBto1555(red, green, blue);
                updateValues(red, green, blue, c1555);
            }

            // get red input value
            document.getElementById("redUserValue").oninput = function() {
                red = this.value;
                green = document.getElementById("greenUserValue").value;
                blue = document.getElementById("blueUserValue").value;
                var c1555 = RGBto1555(red, green, blue); 
                updateValues(red, green, blue, c1555);
            }

            // get green input value
            document.getElementById("greenUserValue").oninput = function() {
                red = document.getElementById("redUserValue").value;
                green = this.value;
                blue = document.getElementById("blueUserValue").value;
                var c1555 = RGBto1555(red, green, blue);
                updateValues(red, green, blue, c1555);
            }

            // get blue input value
            document.getElementById("blueUserValue").oninput = function() {
                red = document.getElementById("redUserValue").value;
                green = document.getElementById("greenUserValue").value;
                blue = this.value;
                var c1555 = RGBto1555(red, green, blue);
                updateValues(red, green, blue, c1555);
            }

            // define all of these variables
            var red = 0;
            var green = 0;
            var blue = 0;
            var n;
            var r;
            var g;
            var b;
            var oldn = 1;
            var oldr = 0;
            var oldg = 0;
            var oldb = 255;
            // set mode
            if (localStorage.getItem("RLP_color_picker_color_mode_090419") == 'dark') darkMode(); // switch to dark mode
            else localStorage.setItem("RLP_color_picker_color_mode_090419","light"); // default mode is light
        </script>
    </body>
</html>
